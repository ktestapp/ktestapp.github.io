<!DOCTYPE html>
<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="HandheldFriendly" content="true">
  <meta name="author" content="bslthemes" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>LSTM-VAE: LSTM Variational AutoEncoder | Waleed Khamies</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="LSTM-VAE: LSTM Variational AutoEncoder" />
<meta name="author" content="Admin" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="LSTM Variational AutoEncoder (LSTM-Sequence-VAE)" />
<meta property="og:description" content="LSTM Variational AutoEncoder (LSTM-Sequence-VAE)" />
<link rel="canonical" href="http://localhost:4000/projects/fashion-magazine" />
<meta property="og:url" content="http://localhost:4000/projects/fashion-magazine" />
<meta property="og:site_name" content="Waleed Khamies" />
<meta property="og:image" content="http://localhost:4000/assets/img/projects/vae_lang.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-08-02T03:57:39-06:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/projects/vae_lang.jpg" />
<meta property="twitter:title" content="LSTM-VAE: LSTM Variational AutoEncoder" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Admin"},"dateModified":"2023-08-02T03:57:39-06:00","datePublished":"2023-08-02T03:57:39-06:00","description":"LSTM Variational AutoEncoder (LSTM-Sequence-VAE)","headline":"LSTM-VAE: LSTM Variational AutoEncoder","image":"http://localhost:4000/assets/img/projects/vae_lang.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/projects/fashion-magazine"},"url":"http://localhost:4000/projects/fashion-magazine"}</script>
<!-- End Jekyll SEO tag -->
<!-- Fonts -->
  <link rel="dns-prefetch" href="//fonts.googleapis.com" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;700;800;900&display=swap" type="text/css" media="all" />
  
  <!-- Load CSS -->
  <link rel="stylesheet" href="/assets/plugins/bootstrap/bootstrap.css" />
  <link rel="stylesheet" href="/assets/plugins/swiper/swiper.css" />
  <link rel="stylesheet" href="/assets/plugins/fancybox/jquery.fancybox.min.css" />
  <link rel="stylesheet" href="/assets/plugins/font-awesome/css/fontawesome.min.css" />
  <link rel="stylesheet" href="/assets/css/syntax.css" />
  <link rel="stylesheet" href="/assets/css/style.css">

  <!--[if lt IE 9]>
  <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- Favicons -->
  <link rel="shortcut icon" href="/assets/images/favicons/favicon.ico"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Waleed Khamies" /></head>


  <body class="page single-page"><!-- preloader start -->
<div class="preloader"> 
	<div>
	<div class="container">
	<div class="squarebox one"></div>
	<div class="squarebox two"></div>
	<div class="squarebox three"></div>
	<div class="squarebox two"></div>
	<div class="squarebox three"></div>
	<div class="squarebox four"></div>
	<div class="squarebox three"></div>
	<div class="squarebox four"></div>
	<div class="squarebox five"></div>
	</div>
	</div>
</div>
<!-- preloader end -->







<header class="header three" style="background-image: url('http://localhost:4000/assets/img/header.jpg');">
	<div class="container">
		<div class="nav">
			<div class="d-flex align-items-center">
			<div class="logo">
				<a href="http://localhost:4000" title="Waleed Khamies">
				<img alt="logo" src="/assets/img/logo.png">
				</a>
			</div>
			<ul class="menu">
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/">Home</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/books/">Books</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/projects/">Projects</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/services/">Services</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/blog/">Blog</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="https://khamiesw.substack.com">Zitoona AI</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="https://shop.waleedkhamies.com">Store</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/news/">News</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/about/">About</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/contact/">Contact</a>
					
				</li>
				
			</ul>
			</div>
			<div>
				<form id="searchForm" class="search-form" method="GET" action="/search.html">
					<input type="text" class="input search-field" id="search-input" value="" />
					<button type="reset" class="search" id="search-btn"></button>
					<ul id="results-container"></ul>
				</form>
				<a href="/contact/" class="themebtu">Contact</a>
			</div>
			<div class="bar-menu">
			<i class="fa-solid fa-bars"></i>
			</div>
		</div>
	</div>
	<div class="mobile-nav hmburger-menu" id="mobile-nav" style="display:block;">
		<div class="res-log">
			<a href="http://localhost:4000" title="Waleed Khamies">
			<img src="http://localhost:4000/assets/img/logo.png" alt="logo">
			</a>
		</div>
		<ul>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/">Home</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/books/">Books</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/projects/">Projects</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/services/">Services</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/blog/">Blog</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="https://khamiesw.substack.com">Zitoona AI</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="https://shop.waleedkhamies.com">Store</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/news/">News</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/about/">About</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/contact/">Contact</a>
				
			</li>
			
		</ul>
		<a href="JavaScript:void(0)" id="res-cross"></a>
	</div>
</header>
<!-- Wrapper -->
    <div class="wrapper portfolio-template">
      





<section class="gap no-top">
	<div class="container">
	  <div class="title-blog">
		<h2>LSTM-VAE: LSTM Variational AutoEncoder</h2>
		<span>NLP</span>
	  </div>
	  <div class="row">
		<div class="col-xl-8">
		  <div class="blog-item hoverstyle">
			
			<figure>
			  <img alt="img" class="w-100" src="http://localhost:4000/assets/img/projects/vae_lang.jpg">
			</figure>
			
			
			<div class="post-content">
				<h2 id="lstm-variational-autoencoder-lstm-sequence-vae">LSTM Variational AutoEncoder (LSTM-Sequence-VAE)</h2>

<p><a href="https://arxiv.org/abs/1511.06349">A PyTorch Implementation of Generating Sentences from a Continuous Space by Bowman et al. 2015.</a></p>

<p><img src="./media/model.jpg" alt="" /></p>

<h3 id="table-of-contents">Table of Contents</h3>

<ul>
  <li><strong><a href="#Introduction">Introduction</a></strong></li>
  <li><strong><a href="#Setup">Setup</a></strong></li>
  <li><a href="#Run-the-code"><strong>Run the code</strong></a></li>
  <li><strong><a href="#Training">Training</a></strong></li>
  <li><strong><a href="#Inference">Inference</a></strong></li>
  <li><strong><a href="#Play-with-the-model">Play with the model</a></strong></li>
  <li><strong><a href="#Connect-with-me">Connect with me</a></strong></li>
  <li><strong><a href="#License">License</a></strong></li>
</ul>

<h3 id="introduction">Introduction</h3>

<p>This is a  <a href="https://arxiv.org/abs/1511.06349">PyTorch Implementation of Generating Sentences from a Continuous Space by Bowman et al. 2015.</a> where LSTM based VAE is trained on Penn Tree Bank dataset.</p>

<h3 id="setup">Setup</h3>

<p>The code is using <code class="language-plaintext highlighter-rouge">pipenv</code> as a virtual environment and package manager. To run the code, all you need is to install the necessary dependencies. open the terminal and type:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">git clone https://github.com/Khamies/Sequence-VAE.git</code></li>
  <li><code class="language-plaintext highlighter-rouge">cd Sequence-VAE</code></li>
  <li><code class="language-plaintext highlighter-rouge">pipenv install</code></li>
</ul>

<p>And you should be ready to go to play with code and build upon it!</p>

<h3 id="run-the-code">Run the code</h3>

<ul>
  <li>
    <p>To train the model, run: <code class="language-plaintext highlighter-rouge">python main.py</code></p>
  </li>
  <li>
    <p>To train the model with specific arguments, run: <code class="language-plaintext highlighter-rouge">python main.py --batch_size=64</code>. The following command-line arguments are available:</p>
    <ul>
      <li>Batch size: <code class="language-plaintext highlighter-rouge">--batch_size</code></li>
      <li>bptt: <code class="language-plaintext highlighter-rouge">--bptt</code></li>
      <li>Learning rate: <code class="language-plaintext highlighter-rouge">--lr</code></li>
      <li>Embedding size: <code class="language-plaintext highlighter-rouge">--embed_size</code></li>
      <li>Hidden size: <code class="language-plaintext highlighter-rouge">--hidden_size</code></li>
      <li>Latent size: <code class="language-plaintext highlighter-rouge">--latent_size</code></li>
    </ul>
  </li>
</ul>

<h3 id="training">Training</h3>

<p>The model is trained on 30 epochs using Adam as an optimizer with a learning rate 0.001. Here are the results from training the LSTM-VAE model:</p>

<ul>
  <li>
    <p><strong>KL Loss</strong></p>

    <p><img src="/assets/img/projects/kl.jpg" align="center" height="300" width="500" /></p>
  </li>
  <li>
    <p><strong>Reconstruction loss</strong></p>

    <p><img src="/assets/img/projects/reco.jpg" align="center" height="300" width="500" /></p>
  </li>
  <li>
    <p><strong>KL loss vs Reconstruction loss</strong></p>

    <p><img src="/assets/img/projects/kl_reco.jpg" align="center" height="300" width="500" /></p>
  </li>
  <li>
    <p><strong>ELBO loss</strong></p>

    <p><img src="/assets/img/projects/elbo.jpg" align="center" height="300" width="500" /></p>
  </li>
</ul>

<h3 id="inference">Inference</h3>

<h4 id="1-sample-generation">1. Sample Generation</h4>

<p>Here are generated samples from the model. We randomly sampled two latent codes z from standard Gaussian distributions, and specify “like” as the start of the sentence (sos), then we feed them to the decoder. The following are the generated sentences:</p>

<ul>
  <li>
    <p><strong>like other countries such as alex powers a former wang marketer</strong></p>
  </li>
  <li>
    <p>**like design and artists have been <unk> by how many <unk>**</unk></unk></p>
  </li>
</ul>

<h4 id="2-interpolation">2. Interpolation</h4>

<p>The “President” word has been used as the start of the sentences. We randomly generated two sentences and interpolated between them.</p>

<ul>
  <li>Sentence 1: <strong>President bush veto power changes meant to be a great number</strong></li>
  <li>Sentence 2: <strong>President bush veto power opposed to the president of the house</strong></li>
</ul>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="err">*</span>bush veto power opposed to the president of the house
 bush veto power opposed to the president of the house.
 bush veto power opposed to the president of the house.
 bush veto power opposed to the president of the house.
 bush veto power opposed to the president of the house.
 bush veto power opposed to the president of the house.
 bush veto power opposed to the president of the house.
 bush veto power opposed to the president of the house.
 bush veto power opposed to the president ' s council.
 bush veto power opposed to the president ' s council.
 bush veto power opposed to the president ' s council.
 bush veto power opposed to the president ' s council.
 bush veto power opposed to the president ' s council.
 bush veto power that kind of <span class="nt">&lt;unk&gt;</span> of natural gas.
 bush veto power changes to keep the <span class="nt">&lt;unk&gt;</span> and that.
 bush veto power changes to keep the <span class="nt">&lt;unk&gt;</span> and that.
 bush veto power changes that is in a telephone to.
 bush veto power changes that is in a telephone to.
 bush veto power changes meant to be a great number.
 <span class="err">*</span>bush veto power changes meant to be a great number
</code></pre></div></div>

<h2 id="play-with-the-model">Play with the model</h2>

<p>To play with the model, a jupyter notebook has been provided, you can find it <a href="https://github.com/Khamies/LSTM-Sequence-VAE/blob/main/play_with_model.ipynb">here</a></p>

<h3 id="citation">Citation</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> @misc{Khamies2021SequenceVAE,
 author = {Khamies, Waleed},
 title = {PyTorch Implementation of Generating Sentences from a Continuous Space by Bowman et al. 2015},
 year = {2021},
 publisher = {GitHub},
 journal = {GitHub repository},
 howpublished = {\url{https://github.com/Khamies/Sequence-VAE}},
 }
</code></pre></div></div>

<h3 id="acknowledgement">Acknowledgement</h3>

<ul>
  <li>This work has been inspired from <a href="https://github.com/timbmg/Sentence-VAE">Sentence-VAE</a> , where their data prepossessing pipeline is used.</li>
</ul>

<h3 id="license">License</h3>

<p><img src="https://img.shields.io/github/license/khamies/LSTM-Sequence-VAE" alt="" /></p>


			</div>
			
			<div class="row align-items-center post-gallery">
				
			</div>

			
			

		  </div>
		  </div>
		  <div class="col-xl-4 pl-60">
		  
		  <ul class="sidebar">
			
			<li>
			  <h4>Project Description : </h4>
			  <span>This is a PyTorch Implementation of Generating Sentences from a Continuous Space by Bowman et al. 2015. where LSTM based VAE is trained on Penn Tree Bank dataset.</span>
			</li>
			
			<li>
			  <h4>Tags : </h4>
			  <span>LSTM, VAE, kl_Divergence, ELBO, Reconstruction Error</span>
			</li>
			
			<li>
			  <h4>Year : </h4>
			  <span>2021</span>
			</li>
			
			<li>
			  <h4>Category :</h4>
			  <span>NLP</span>
			</li>
			<li>
			  <h4>Share :</h4>
			  <ul class="brandicon">
				<li><a href="#" class="share-btn share-btn-facebook share-btn-1" title="Share on Facebook"><i class="fa-brands fa-facebook-f"></i></a></li>
				<li><a href="#" class="share-btn share-btn-twitter share-btn-2" title="Share on Twitter"><i class="fa-brands fa-twitter"></i></a></li>
				<li><a href="#" class="share-btn share-btn-reddit share-btn-3" title="Share on Reddit"><i class="fa-brands fa-reddit"></i></a></li>
				<li><a href="#" class="share-btn share-btn-pinterest share-btn-4" title="Share on Pinterest"><i class="fa-brands fa-pinterest"></i></a></li>
				<li><a href="#" class="share-btn share-btn-linkedin share-btn-5" title="Share on Linkedin"><i class="fa-brands fa-linkedin-in"></i></a></li>
			  </ul>
			</li>
			<li>
			  <a href="https://github.com/Khamies/LSTM-Variational-AutoEncoder" class="themebtu">Access</a>
			</li>
		  </ul>
		</div>
		</div>
		
	  </div>
  </section>

  
  <div class="next-previous-page">
	<div class="container">
	  <div class="next-previous">
		
		
		<div class="next">
		  <a href="/projects/lonest-photography-autre-copie" title="Lonest Photography">Next Project
		  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
			 viewBox="0 0 476.213 476.213" style="enable-background:new 0 0 476.213 476.213;" xml:space="preserve">
		  <polygon points="405.606,167.5 384.394,188.713 418.787,223.106 0,223.106 0,253.106 418.787,253.106 384.394,287.5 
			405.606,308.713 476.213,238.106 "/>
		  </svg>
		  </a>
		</div>
		
	  </div>
	</div>
  </div>
  
    </div>

    <!-- Footer -->




<!-- Footer -->
<footer class="footer gap no-bottom" style="background-color: #222 ;">
	<div class="container">
	  <div class="row">
		<div class="col-xl-3 col-lg-4 col-md-6">
		  <div class="footer-logo">
			<a href="http://localhost:4000" title="Waleed Khamies"><img alt="logo" src="http://localhost:4000/assets/img/logo.png"></a>
			<p>
			  Applied ML Scientist
			</p>
		  </div>
		</div>
		<div class="col-xl-3 col-lg-4 col-md-6">
		  <div class="links">
			<h6>Additional Links</h6>
			<ul>
        	  
			  <li><a href="http://localhost:4000/about/">About Us</a></li>
			  
			  <li><a href="http://localhost:4000/services/">Services</a></li>
			  
			  <li><a href="http://localhost:4000/team/">Team</a></li>
			  
			  <li><a href="http://localhost:4000/blog/">News</a></li>
			  
			  <li><a href="http://localhost:4000/contact/">Contact Us</a></li>
			  
			</ul>
		  </div>
		</div>
		<div class="col-xl-3 col-lg-4 col-md-6">
		  
		  <div class="latest-news">
			<h6>Latest News</h6>
			<ul>
			  
			  <li class="pt-4">
				  <p><a href="/documentation/2021/07/13/designer-conference-at-florida-2020/">Designer Conference at Florida 2020</a></p>
				  <span>13 July 2021</span>
			  </li>
			  
			  <li class="pt-4">
				  <p><a href="/design/2021/07/13/you-must-know-this-before-becoming-a-designer/">You must know this before becoming a designer</a></p>
				  <span>13 July 2021</span>
			  </li>
			  
			</ul>
		  </div>
		  
		</div>
		<div class="col-xl-3 col-lg-4 col-md-6">
		  <div class="latest-news">
			<h6>Subscribe</h6>
			<p>Pellentesque odio nisi, euismod in, pharetra a, ultricies in, diam.</p>
			<form class="subscribe-form" action="" method="post" target="_blank">
				<input type="text" name="EMAIL" placeholder="your email address">
				<input type="hidden" name="">
				<button type="submit">Go</button>
			</form>
		  </div>
		</div>
	  </div>
	  <div class="footer-bottom">
		<p>&copy; 2023 Waleed Khamies - All Rights Reserved | Developed by <a href="https://bslthemes.com" target="_blank">bslthemes</a></p>
		<ul>
      	  
		  <li><a href="https://twitter.com/khamiesw" target="_blank" title="Twitter"><i aria-hidden="true" class="fa-brands fa-twitter"></i></a></li>
		  
		  <li><a href="https://www.medium.com/@khamiesw" target="_blank" title="Medium"><i aria-hidden="true" class="fa-solid fa-m"></i></a></li>
		  
		  <li><a href="https://www.linkedin.com/in/khamiesw/" target="_blank" title="Linkedin"><i aria-hidden="true" class="fa-brands fa-linkedin-in"></i></a></li>
		  
		</ul>
	  </div>
	</div>
</footer>
<!-- Back to Top -->
    <a href="#." id="button"></a>

    <!-- Scripts --><!-- Plugins -->
<script src="/assets/plugins/jQuery/jquery.min.js"></script>
<script src="/assets/plugins/bootstrap/bootstrap.js"></script>
<script src="/assets/plugins/validate/jquery.validate.min.js"></script>
<script src="/assets/plugins/fancybox/jquery.fancybox.min.js"></script>
<script src="/assets/plugins/imagesloaded/imagesloaded.pkgd.js"></script>
<script src="/assets/plugins/isotope/isotope.pkgd.js"></script>
<script src="/assets/plugins/isotope/isotope-init.js"></script>
<script src="/assets/plugins/swiper/swiper.js"></script>
<script src="/assets/plugins/rrssb/rrssb.js"></script>
<script src="/assets/js/simple-jekyll-search.js"></script>
<script src="/assets/js/form-handler.js"></script>

<!-- Main -->
<script src="/assets/js/common.js"></script>
</body>

</html>
