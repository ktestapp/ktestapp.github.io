<!DOCTYPE html>
<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="HandheldFriendly" content="true">
  <meta name="author" content="bslthemes" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>TLT : Transformer Lightning Language Model | Waleed Khamies</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="TLT : Transformer Lightning Language Model" />
<meta name="author" content="Admin" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="TLT : Transformer Lightning Language Model" />
<meta property="og:description" content="TLT : Transformer Lightning Language Model" />
<link rel="canonical" href="http://localhost:4000/projects/light-tr" />
<meta property="og:url" content="http://localhost:4000/projects/light-tr" />
<meta property="og:site_name" content="Waleed Khamies" />
<meta property="og:image" content="http://localhost:4000/assets/img/projects/lig_cover.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-08-02T20:32:25-06:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/projects/lig_cover.png" />
<meta property="twitter:title" content="TLT : Transformer Lightning Language Model" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Admin"},"dateModified":"2023-08-02T20:32:25-06:00","datePublished":"2023-08-02T20:32:25-06:00","description":"TLT : Transformer Lightning Language Model","headline":"TLT : Transformer Lightning Language Model","image":"http://localhost:4000/assets/img/projects/lig_cover.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/projects/light-tr"},"url":"http://localhost:4000/projects/light-tr"}</script>
<!-- End Jekyll SEO tag -->
<!-- Fonts -->
  <link rel="dns-prefetch" href="//fonts.googleapis.com" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;700;800;900&display=swap" type="text/css" media="all" />
  
  <!-- Load CSS -->
  <link rel="stylesheet" href="/assets/plugins/bootstrap/bootstrap.css" />
  <link rel="stylesheet" href="/assets/plugins/swiper/swiper.css" />
  <link rel="stylesheet" href="/assets/plugins/fancybox/jquery.fancybox.min.css" />
  <link rel="stylesheet" href="/assets/plugins/font-awesome/css/fontawesome.min.css" />
  <link rel="stylesheet" href="/assets/css/syntax.css" />
  <link rel="stylesheet" href="/assets/css/style.css">

  <!--[if lt IE 9]>
  <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- Favicons -->
  <link rel="shortcut icon" href="/assets/images/favicons/favicon.ico"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Waleed Khamies" /></head>


  <body class="page single-page"><!-- preloader start -->
<div class="preloader"> 
	<div>
	<div class="container">
	<div class="squarebox one"></div>
	<div class="squarebox two"></div>
	<div class="squarebox three"></div>
	<div class="squarebox two"></div>
	<div class="squarebox three"></div>
	<div class="squarebox four"></div>
	<div class="squarebox three"></div>
	<div class="squarebox four"></div>
	<div class="squarebox five"></div>
	</div>
	</div>
</div>
<!-- preloader end -->







<header class="header three" style="background-image: url('http://localhost:4000/assets/img/header.jpg');">
	<div class="container">
		<div class="nav">
			<div class="d-flex align-items-center">
			<div class="logo">
				<a href="http://localhost:4000" title="Waleed Khamies">
				<img alt="logo" src="/assets/img/logo.png">
				</a>
			</div>
			<ul class="menu">
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/">Home</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/books/">Books</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/projects/">Projects</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/services/">Services</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/blog/">Blog</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="https://khamiesw.substack.com">Zitoona AI</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="https://shop.waleedkhamies.com">Store</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/news/">News</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/about/">About</a>
					
				</li>
				
				
				<li class="menu-item">
					<a class="splitting-text-anim-2" data-splitting="chars" href="/contact/">Contact</a>
					
				</li>
				
			</ul>
			</div>
			<div>
				<form id="searchForm" class="search-form" method="GET" action="/search.html">
					<input type="text" class="input search-field" id="search-input" value="" />
					<button type="reset" class="search" id="search-btn"></button>
					<ul id="results-container"></ul>
				</form>
				<a href="/contact/" class="themebtu">Contact</a>
			</div>
			<div class="bar-menu">
			<i class="fa-solid fa-bars"></i>
			</div>
		</div>
	</div>
	<div class="mobile-nav hmburger-menu" id="mobile-nav" style="display:block;">
		<div class="res-log">
			<a href="http://localhost:4000" title="Waleed Khamies">
			<img src="http://localhost:4000/assets/img/logo.png" alt="logo">
			</a>
		</div>
		<ul>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/">Home</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/books/">Books</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/projects/">Projects</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/services/">Services</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/blog/">Blog</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="https://khamiesw.substack.com">Zitoona AI</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="https://shop.waleedkhamies.com">Store</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/news/">News</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/about/">About</a>
				
			</li>
			
			
			<li class="menu-item">
				<a class="splitting-text-anim-2" data-splitting="chars" href="/contact/">Contact</a>
				
			</li>
			
		</ul>
		<a href="JavaScript:void(0)" id="res-cross"></a>
	</div>
</header>
<!-- Wrapper -->
    <div class="wrapper portfolio-template">
      





<section class="gap no-top">
	<div class="container">
	  <div class="title-blog">
		<h2>TLT : Transformer Lightning Language Model</h2>
		<span>NLP</span>
	  </div>
	  <div class="row">
		<div class="col-xl-8">
		  <div class="blog-item hoverstyle">
			
			<figure>
			  <img alt="img" class="w-100" src="http://localhost:4000/assets/img/projects/lig_cover.png">
			</figure>
			
			
			<div class="post-content">
				<h2 id="tlt--transformer-lightning-language-model">TLT : Transformer Lightning Language Model</h2>

<h3 id="table-of-contents">Table of Contents</h3>

<ul>
  <li><strong><a href="#Introduction">Introduction</a></strong></li>
  <li><strong><a href="#Setup">Setup</a></strong></li>
  <li><a href="#Run-the-code"><strong>Run the code</strong></a></li>
  <li><strong><a href="#Training">Training</a></strong></li>
  <li><strong><a href="#Sample-Generation">Sample Generation</a></strong></li>
  <li><strong><a href="#Connect-with-me">Connect with me</a></strong></li>
  <li><strong><a href="#License">License</a></strong></li>
</ul>

<h3 id="introduction">Introduction</h3>

<p>This is an implementation of a transformer based language model using <a href="https://www.pytorchlightning.ai/">Pytorch-Lightning framework</a>. The model consists of two transformer layers with 2 heads each combined with embedding and linear layers. The code uses pytorch-lightning framework that is built for fast research prototyping. Although the code does not leverage all the features of the lightning framework, but it has achieved good result in the language modelling task. For learning purposes, a Pytorch classical version from this project is also provided <a href="https://colab.research.google.com/drive/1zRm0tfD2gYyL2WNd6o_mVC2IY3prAzPV?usp=sharing">here</a> (inspired from Pytorch team  :heart:).</p>

<p><img src="/assets/img/projects/lig_transformer.jpg" align="center" height="750" width="800" /></p>

<h3 id="setup">Setup</h3>

<p>The code is using <code class="language-plaintext highlighter-rouge">pipenv</code> as a virtual environment and package manager. To run the code, all you need is to install the necessary dependencies. open the terminal and type:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">$ git clone https://github.com/Khamies/Transformer_Lightning.git</code></li>
  <li><code class="language-plaintext highlighter-rouge">$ cd Transformer_Lightning</code></li>
  <li><code class="language-plaintext highlighter-rouge">$ pipenv install</code></li>
</ul>

<p>or</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">$ pip install requirements.txt </code></li>
</ul>

<p>And you should be ready to go to play with code and build upon it!</p>

<h3 id="run-the-code">Run the code</h3>

<ul>
  <li>
    <p>To train the model, run: <code class="language-plaintext highlighter-rouge">python main.py</code></p>
  </li>
  <li>
    <p>To train the model with specific arguments, run: <code class="language-plaintext highlighter-rouge">python main.py --batch_size=64</code>. The following command-line arguments are available:</p>
    <ul>
      <li>Train batch size: <code class="language-plaintext highlighter-rouge">--bsz_train</code></li>
      <li>Test batch size: <code class="language-plaintext highlighter-rouge">--bsz_test</code></li>
      <li>bptt: <code class="language-plaintext highlighter-rouge">--bptt</code></li>
      <li>Learning rate: <code class="language-plaintext highlighter-rouge">--lr</code></li>
      <li>Embedding size: <code class="language-plaintext highlighter-rouge">--embed_size</code></li>
      <li>Size of FeedForward Neural Network (1st layer): <code class="language-plaintext highlighter-rouge">--ffnn_size</code></li>
      <li>Attention Heads: <code class="language-plaintext highlighter-rouge">--nhead</code></li>
      <li>Transformer Layers: <code class="language-plaintext highlighter-rouge">--nlayers</code></li>
    </ul>
  </li>
</ul>

<h3 id="training">Training</h3>

<p>The model is trained on <code class="language-plaintext highlighter-rouge">10 epochs</code> using Adam as an optimizer with a <code class="language-plaintext highlighter-rouge">learning rate = 0.001</code> and <code class="language-plaintext highlighter-rouge">batch size = 32</code>, you can find all the model settings in <a href="https://github.com/Khamies/Transformer_Lightning/blob/main/settings.py">settings.py</a>. Here is the loss curve for the training step:</p>

<ul>
  <li>
    <p><strong>Cross Entropy Loss</strong></p>

    <p><img src="/assets/img/projects/lig_train_loss.jpg" align="center" height="300" width="500" /></p>
  </li>
</ul>

<h3 id="sample-generation">Sample Generation</h3>

<p>Here are some generated samples from the model:</p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;time&gt;</span> warner owns n million francs.
<span class="nt">&lt;media&gt;</span> concern said it is a share n million.
</code></pre></div></div>

<h3 id="citation">Citation</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> @misc{Khamies2021Transformer_Lightning,
author = {Khamies, Waleed},
title = {A pytorch implementation of transformer based language model using Pytorch-Lightning framework.},
year = {2021},
publisher = {GitHub},
journal = {GitHub repository},
howpublished = {\url{ https://github.com/Khamies/Transformer_Lightning}},
}
</code></pre></div></div>

<h3 id="license">License</h3>

<p><img src="https://img.shields.io/github/license/Khamies/Transformer_Lightning" alt="" /></p>


			</div>
			
			<div class="row align-items-center post-gallery">
				
			</div>

			
			

		  </div>
		  </div>
		  <div class="col-xl-4 pl-60">
		  
		  <ul class="sidebar">
			
			<li>
			  <h4>Project Description : </h4>
			  <span>A simple implementation of a transformer based language model using Pytorch-Lightning.</span>
			</li>
			
			<li>
			  <h4>Tags : </h4>
			  <span>pytorch, transformer, language-model, cross-entropy, pytorch-lightning</span>
			</li>
			
			<li>
			  <h4>Year : </h4>
			  <span>2021</span>
			</li>
			
			<li>
			  <h4>Category :</h4>
			  <span>NLP</span>
			</li>
			<li>
			  <h4>Share :</h4>
			  <ul class="brandicon">
				<li><a href="#" class="share-btn share-btn-facebook share-btn-1" title="Share on Facebook"><i class="fa-brands fa-facebook-f"></i></a></li>
				<li><a href="#" class="share-btn share-btn-twitter share-btn-2" title="Share on Twitter"><i class="fa-brands fa-twitter"></i></a></li>
				<li><a href="#" class="share-btn share-btn-reddit share-btn-3" title="Share on Reddit"><i class="fa-brands fa-reddit"></i></a></li>
				<li><a href="#" class="share-btn share-btn-pinterest share-btn-4" title="Share on Pinterest"><i class="fa-brands fa-pinterest"></i></a></li>
				<li><a href="#" class="share-btn share-btn-linkedin share-btn-5" title="Share on Linkedin"><i class="fa-brands fa-linkedin-in"></i></a></li>
			  </ul>
			</li>
			<li>
			  <a href="https://github.com/Khamies/Transformer_Lightning" class="themebtu">Access</a>
			</li>
		  </ul>
		</div>
		</div>
		
	  </div>
  </section>

  
  <div class="next-previous-page">
	<div class="container">
	  <div class="next-previous">
		
		
		<div class="next">
		  <a href="/projects/lstm-vae" title="LSTM-VAE: LSTM Variational AutoEncoder">Next Project
		  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
			 viewBox="0 0 476.213 476.213" style="enable-background:new 0 0 476.213 476.213;" xml:space="preserve">
		  <polygon points="405.606,167.5 384.394,188.713 418.787,223.106 0,223.106 0,253.106 418.787,253.106 384.394,287.5 
			405.606,308.713 476.213,238.106 "/>
		  </svg>
		  </a>
		</div>
		
	  </div>
	</div>
  </div>
  
    </div>

    <!-- Footer -->




<!-- Footer -->
<footer class="footer gap no-bottom" style="background-color: #222 ;">
	<div class="container">
	  <div class="row">
		<div class="col-xl-3 col-lg-4 col-md-6">
		  <div class="footer-logo">
			<a href="http://localhost:4000" title="Waleed Khamies"><img alt="logo" src="http://localhost:4000/assets/img/logo.png"></a>
			<p>
			  Applied ML Scientist
			</p>
		  </div>
		</div>
		<div class="col-xl-3 col-lg-4 col-md-6">
		  <div class="links">
			<h6>Additional Links</h6>
			<ul>
        	  
			  <li><a href="http://localhost:4000/about/">About Us</a></li>
			  
			  <li><a href="http://localhost:4000/services/">Services</a></li>
			  
			  <li><a href="http://localhost:4000/team/">Team</a></li>
			  
			  <li><a href="http://localhost:4000/blog/">News</a></li>
			  
			  <li><a href="http://localhost:4000/contact/">Contact Us</a></li>
			  
			</ul>
		  </div>
		</div>
		<div class="col-xl-3 col-lg-4 col-md-6">
		  
		  <div class="latest-news">
			<h6>Latest News</h6>
			<ul>
			  
			  <li class="pt-4">
				  <p><a href="/documentation/2021/07/13/designer-conference-at-florida-2020/">Designer Conference at Florida 2020</a></p>
				  <span>13 July 2021</span>
			  </li>
			  
			  <li class="pt-4">
				  <p><a href="/design/2021/07/13/you-must-know-this-before-becoming-a-designer/">You must know this before becoming a designer</a></p>
				  <span>13 July 2021</span>
			  </li>
			  
			</ul>
		  </div>
		  
		</div>
		<div class="col-xl-3 col-lg-4 col-md-6">
		  <div class="latest-news">
			<h6>Subscribe</h6>
			<p>Pellentesque odio nisi, euismod in, pharetra a, ultricies in, diam.</p>
			<form class="subscribe-form" action="" method="post" target="_blank">
				<input type="text" name="EMAIL" placeholder="your email address">
				<input type="hidden" name="">
				<button type="submit">Go</button>
			</form>
		  </div>
		</div>
	  </div>
	  <div class="footer-bottom">
		<p>&copy; 2023 Waleed Khamies - All Rights Reserved | Developed by <a href="https://bslthemes.com" target="_blank">bslthemes</a></p>
		<ul>
      	  
		  <li><a href="https://twitter.com/khamiesw" target="_blank" title="Twitter"><i aria-hidden="true" class="fa-brands fa-twitter"></i></a></li>
		  
		  <li><a href="https://www.medium.com/@khamiesw" target="_blank" title="Medium"><i aria-hidden="true" class="fa-solid fa-m"></i></a></li>
		  
		  <li><a href="https://www.linkedin.com/in/khamiesw/" target="_blank" title="Linkedin"><i aria-hidden="true" class="fa-brands fa-linkedin-in"></i></a></li>
		  
		</ul>
	  </div>
	</div>
</footer>
<!-- Back to Top -->
    <a href="#." id="button"></a>

    <!-- Scripts --><!-- Plugins -->
<script src="/assets/plugins/jQuery/jquery.min.js"></script>
<script src="/assets/plugins/bootstrap/bootstrap.js"></script>
<script src="/assets/plugins/validate/jquery.validate.min.js"></script>
<script src="/assets/plugins/fancybox/jquery.fancybox.min.js"></script>
<script src="/assets/plugins/imagesloaded/imagesloaded.pkgd.js"></script>
<script src="/assets/plugins/isotope/isotope.pkgd.js"></script>
<script src="/assets/plugins/isotope/isotope-init.js"></script>
<script src="/assets/plugins/swiper/swiper.js"></script>
<script src="/assets/plugins/rrssb/rrssb.js"></script>
<script src="/assets/js/simple-jekyll-search.js"></script>
<script src="/assets/js/form-handler.js"></script>

<!-- Main -->
<script src="/assets/js/common.js"></script>
</body>

</html>
